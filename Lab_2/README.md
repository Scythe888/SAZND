# Системы аутентификации и защиты от несанкционированного доступа

Лабораторная работа №2

## Цель

1. Развить практические навыки использования современного стека инструментов сбора и аналитической обработки информации о сетвом трафике
2. Освоить базовые подходы блокировки нежелательного сетевого трафика
3. Закрепить знания о современных сетевых протоколах прикладного уровня

## ️Исходные данные

1. ПК с ОС Windows 10
2. Virtual Box с ОС Ubuntu 22.04
3. Программа-анализатор трафика для компьютерных сетей - Wireshark
4. Python 3.10

## ️Задание

1. Собрать сетевой трафик (объемом не менее 100 Мб)
2. Выделить метаинформацию сетевого трафика с помощью утилиты Zeek
3. Собрать данные об источниках нежелательного трафика, например – https://github.com/StevenBlack
4. Написать программу на любом удобном языке (python, bash, R …), котрая подсчитывает процент нежелательного трафика в собранном на этапе 1.
5. Оформить отчет в соответствии с шаблоном

## ️Общий план выполнения

Работу целесообразно разделить на 2 этапа: сбора собственных данных и сбора данных о нежелательном
трафике.

## Содержание ЛР

### Шаг 1

Собрать сетевой трафик (объемом не менее 100 Мб)

1. Воспользоваться сетевым анализаторам – Wireshark
2. Для формирования необходимого объема, после начала записи трафика посерфить Интернет: поискать в поисковых движках, полазить по новостям и т.д. Не рекомендуется формировать весь объем трафика за счет использования одним сервисом – Telegram, Youtube, TikTok и пр. – так как собранный
сетевой профиль будет без характерных черт, котрые можно будет затем отобразить и проанализировать на последующих этапах.

![image](https://github.com/Nosochekir/SAZND/assets/90778008/e485e66f-ad85-43be-bd6f-5adb1e48e1f5)

### Шаг 2

Выделить метаинформацию сетевого трафика с помощью утилиты Zeek:
zeek –C –r traffic.pcapng

Вычленить адреса из dns.log:
awk '/^[^#]/ {print $10}' dns.log >> dns

Полученные файлы:

![image](https://github.com/Nosochekir/SAZND/assets/90778008/0ec76eac-505c-46e5-9ff7-25cd3f6337fb)


### Шаг 3

Собрать данные об источниках нежелательного трафика, в данном случае с github – [https://github.com/StevenBlack/hosts/blob/master/data/KADhosts/hosts](https://github.com/StevenBlack/hosts/tree/master/data)

``` bash
curl https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts -o /home/vlad/hosts
```
```
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 5925k  100 5925k    0     0  4510k      0  0:00:01  0:00:01 --:--:-- 4512k

```

### Шаг 4

Написана программа на языке Python 3.10, которая подсчитывает процент
нежелательного трафика в собранном на этапе 1:

Код:
```
bad_hosts = [] # нежелательные хосты
with open('hosts') as file:
    for line in file.readlines()[40:]:
        if line[0] == '#':
            continue
        try:
            bad_hosts.append(line.split()[1])
        except IndexError:
            continue
        
hosts = [] # все хосты
with open('dns.log') as file:
    for line in file.readlines():
        if line[0] == '#':
            continue
        try:
            hosts.append(line.split()[9])
        except IndexError:
            continue

bad_count = len([host for host in hosts if host in bad_hosts])
percentile = round(bad_count/len(hosts),3)*100
print("Количество нежелательных хостов: {}.".format(str(bad_count)),
"Процент нежелательного трафика: {}%.".format(str(percentile)),sep='\n')
```
## ️Оценка результата

Собрано 100+ Мб трафика

Собраны данные об источниках нежелательного трафика

Проведенно их сравнение, найденны записи нежелательного трафика в нашем 

Подсчитали процент нежелательного трафика

Получены результаты:

![image](https://github.com/Nosochekir/SAZND/assets/90778008/a07f638d-bfe0-46eb-a7e2-9e80ab85197f)

## ️Вывод 

В результате выполнения работы были освоены основные инструменты сбора трафика через Wireshark, выделения информации о dns собранного трафика с помощью Zeek и анализа нежелательного трафика.
